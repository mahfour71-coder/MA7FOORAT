<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سلة المشتريات - MAHFOOR CNC</title>
    <!-- خطوط عربية أنيقة من Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Amiri:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="mobile.css" media="(max-width: 768px)">
    <style>
        :root {
            --wood-dark: #7c5e42;      /* اللون البني الرئيسي من الموقع */
            --wood-light: #d9c8a9;     /* اللون البيج من الهيدر */
            --nature-green: #13352f;   /* اللون الأخضر الداكن من الموقع */
            --cream-bg: #f5f0e8;       /* خلفية كريمية متناسقة */
            --white: #FFFFFF;
            --shadow: rgba(107, 79, 75, 0.15); /* ظل أنعم */
            --accent-gold: #ff9800;    /* اللون البرتقالي للتأثيرات */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background: linear-gradient(to bottom, #7c5e42, #d9c8a9);
            color: #444;
            min-height: 100vh;
            padding: 20px 10px;
            background-attachment: fixed;
        }

        .cart-container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px var(--shadow);
            position: relative;
        }

        /* شريط علوي خشبي فاخر */
        .header-bar {
            background: linear-gradient(135deg, var(--wood-dark) 0%, #6d4c41 100%);
            padding: 15px 30px;
            color: white;
            text-align: center;
            border-bottom: 4px solid var(--wood-light);
        }

        .header-bar h1 {
            margin: 0;
            font-family: 'Amiri', serif;
            font-size: 1.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header-bar p {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 5px;
        }

        /* محتوى السلة */
        .cart-content {
            padding: 30px;
        }

        .cart-items {
            margin-bottom: 25px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            background: var(--white);
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 18px;
            border: 1px solid #E0D4B5;
            transition: all 0.3s ease;
            overflow: hidden;
            animation: cardFadeIn 0.5s ease-out forwards;
            opacity: 0;
        }

        .cart-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }

        .item-image {
            width: 90px;
            height: 90px;
            border-radius: 12px;
            object-fit: cover;
            margin-left: 25px;
            border: 2px solid var(--wood-light);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .item-details {
            flex: 1;
            padding: 0 15px;
        }

        .item-details h3 {
            color: var(--wood-dark);
            font-size: 1.3em;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .item-details .price {
            color: var(--wood-dark);
            font-weight: 800;
            font-size: 1.2em;
            margin: 8px 0;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 6px 12px;
            border-radius: 30px;
            border: 1px solid var(--wood-light);
            width: fit-content;
        }

        .qty-btn {
            background: transparent;
            color: var(--wood-dark);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 1.3em;
            cursor: pointer;
            transition: 0.3s;
            font-weight: bold;
        }

        .qty-btn:hover {
            background: var(--cream-bg);
            color: var(--accent-gold);
        }

        .qty-input {
            width: 50px;
            text-align: center;
            border: none;
            font-weight: bold;
            font-size: 1.1em;
            background: transparent;
        }

        .remove-btn {
            background: transparent;
            color: #D9534F;
            border: none;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            font-size: 1.6em;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            font-weight: bold;
        }

        .remove-btn:hover {
            background: #FBEAE9;
            transform: scale(1.1);
        }

        /* الإجمالي */
        .cart-summary {
            background: var(--cream-bg);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px dashed var(--wood-dark);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .summary-row.total {
            font-weight: 700;
            font-size: 1.4em;
            color: var(--wood-dark);
            border-top: 1px solid var(--wood-light);
            padding-top: 12px;
            margin-top: 15px;
        }

        /* الأزرار */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .btn {
            flex: 1;
            padding: 16px;
            font-size: 1.2em;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .checkout-btn {
            background: linear-gradient(135deg, var(--nature-green) 0%, #1a4a41 100%);
            color: white;
            box-shadow: 0 6px 15px rgba(22, 59, 47, 0.3);
        }

        .checkout-btn:hover {
            background: linear-gradient(135deg, var(--accent-gold) 0%, #e68900 100%);
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
        }

        .continue-shopping {
            background: var(--wood-light);
            color: var(--wood-dark);
            border: 2px solid var(--wood-dark) !important;
        }

        .continue-shopping:hover {
            background: var(--wood-dark);
            color: white;
        }

        /* رسالة السلة الفارغة */
        .empty-cart {
            text-align: center;
            padding: 60px 20px;
            color: var(--wood-dark);
            font-size: 1.3em;
        }

        .empty-cart i {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        /* ديكور أوراق متحركة */
        .leaf-decoration {
            fill: var(--wood-dark);
            position: absolute;
            opacity: 0.08;
            pointer-events: none;
            width: 50px;
            animation: float 6s infinite ease-in-out;
        }

        .leaf1 { top: 10%; left: 5%; animation-delay: 0s; }
        .leaf2 { top: 30%; right: 8%; animation-delay: 2s; }
        .leaf3 { bottom: 15%; left: 10%; animation-delay: 4s; }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        @keyframes cardFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

    <div class="cart-container">
        <!-- شريط علوي فاخر -->
        <div class="header-bar">
            <h1>MAHFOOR CNC</h1>
            <p>Nature Tells Your Story</p>
        </div>

        <!-- ديكور أوراق -->
        <svg class="leaf-decoration leaf1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66C7.94 16.83 12 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-2a5 5 0 0 1 5 5 5 5 0 0 1-5 5c-5.83 0-9.48-4.5-11.91-10.31L3 11.34C3 11.34 3 11.33 3 11.32C3 11.32 3 11.31 3 11.3C3 11.29 3 11.28 3 11.27C3.03 10.68 3.18 9.81 3.45 8.71C2.6 7.14 2.1 5.4 2.04 3.5C2.03 3.17 2.29 2.89 2.62 2.89c.32 0 .59.25.62.57c.05 1.6 0.5 3.05 1.25 4.36C5.5 6.26 6.5 5 8 5a3 3 0 0 1 3 3c0 1.33-.89 2.44-2.1 2.84C10.4 12.91 12.87 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3"/>
        </svg>
        <svg class="leaf-decoration leaf2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66C7.94 16.83 12 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-2a5 5 0 0 1 5 5 5 5 0 0 1-5 5c-5.83 0-9.48-4.5-11.91-10.31L3 11.34C3 11.34 3 11.33 3 11.32C3 11.32 3 11.31 3 11.3C3 11.29 3 11.28 3 11.27C3.03 10.68 3.18 9.81 3.45 8.71C2.6 7.14 2.1 5.4 2.04 3.5C2.03 3.17 2.29 2.89 2.62 2.89c.32 0 .59.25.62.57c.05 1.6 0.5 3.05 1.25 4.36C5.5 6.26 6.5 5 8 5a3 3 0 0 1 3 3c0 1.33-.89 2.44-2.1 2.84C10.4 12.91 12.87 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3"/>
        </svg>
        <svg class="leaf-decoration leaf3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66C7.94 16.83 12 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-2a5 5 0 0 1 5 5 5 5 0 0 1-5 5c-5.83 0-9.48-4.5-11.91-10.31L3 11.34C3 11.34 3 11.33 3 11.32C3 11.32 3 11.31 3 11.3C3 11.29 3 11.28 3 11.27C3.03 10.68 3.18 9.81 3.45 8.71C2.6 7.14 2.1 5.4 2.04 3.5C2.03 3.17 2.29 2.89 2.62 2.89c.32 0 .59.25.62.57c.05 1.6 0.5 3.05 1.25 4.36C5.5 6.26 6.5 5 8 5a3 3 0 0 1 3 3c0 1.33-.89 2.44-2.1 2.84C10.4 12.91 12.87 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3"/>
        </svg>

        <div class="cart-content">
            <div class="cart-items">
                <!-- المنتجات تُضاف ديناميكيًا -->
            </div>

            <div class="cart-summary">
                <div class="summary-row">
                    <span>المجموع الفرعي</span>
                    <span id="subtotal">0 جنيه</span>
                </div>
                <div class="summary-row">
                    <span>الشحن</span>
                    <span>حسب مكانك</span>
                </div>
                <div class="summary-row total">
                    <span>الإجمالي</span>
                    <span id="total-price">0 جنيه</span>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn checkout-btn">إكمال الشراء عبر واتساب</button>
                <button class="btn continue-shopping" onclick="window.location.href='index.html'">متابعة التسوق</button>
            </div>
        </div>
    </div>

    <script>
        // تخزين السلة في localStorage
        let cart = JSON.parse(localStorage.getItem('mahfoor_cart')) || [];

        // عرض السلة
        function renderCart() {
            const cartItems = document.querySelector('.cart-items');
            const subtotalEl = document.getElementById('subtotal');
            const totalEl = document.getElementById('total-price');
            cartItems.innerHTML = '';
            let subtotal = 0;

            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <div style="opacity: 0.3; width: 80px; margin: 0 auto 20px;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="var(--wood-dark)"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66C7.94 16.83 12 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-2a5 5 0 0 1 5 5 5 5 0 0 1-5 5c-5.83 0-9.48-4.5-11.91-10.31L3 11.34C3 11.34 3 11.33 3 11.32C3 11.32 3 11.31 3 11.3C3 11.29 3 11.28 3 11.27C3.03 10.68 3.18 9.81 3.45 8.71C2.6 7.14 2.1 5.4 2.04 3.5C2.03 3.17 2.29 2.89 2.62 2.89c.32 0 .59.25.62.57c.05 1.6 0.5 3.05 1.25 4.36C5.5 6.26 6.5 5 8 5a3 3 0 0 1 3 3c0 1.33-.89 2.44-2.1 2.84C10.4 12.91 12.87 14 17 14a3 3 0 0 0 3-3 3 3 0 0 0-3-3"/></svg>
                        </div>
                        <p>سلة المشتريات فارغة</p>
                        <p style="font-size: 0.9em; margin-top: 10px; color: #777;">
                            ابدأ التسوق في عالم الخشب الطبيعي
                        </p>
                    </div>`;
                subtotalEl.textContent = '0 جنيه';
                totalEl.textContent = '0 جنيه';
                return;
            }

            cart.forEach((item, index) => { 
                const animationDelay = `${index * 0.1}s`;
                const price = parseFloat(item.price);
                subtotal += price * item.qty;

                const div = document.createElement('div');
                div.className = 'cart-item';
                div.style.animationDelay = animationDelay;
                div.innerHTML = `
                    <img src="${item.image || 'https://via.placeholder.com/90?text=خشب'}" alt="${item.name}" class="item-image">
                    <div class="item-details">
                        <h3>${item.name}</h3>
                        <p class="price">${price.toFixed(2)} جنيه</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="updateQty(${index}, -1)">−</button>
                            <input type="number" value="${item.qty}" min="1" class="qty-input" onchange="setQty(${index}, this.value)">
                            <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
                        </div>
                    </div>
                    <button class="remove-btn" onclick="removeItem(${index})">×</button>
                `;
                cartItems.appendChild(div);
            });

            subtotalEl.textContent = `${subtotal.toFixed(2)} جنيه`;
            totalEl.textContent = `${subtotal.toFixed(2)} جنيه`;
            localStorage.setItem('mahfoor_cart', JSON.stringify(cart));
        }

        // تحديث الكمية
        function updateQty(index, change) {
            const newQty = cart[index].qty + parseInt(change);
            if (newQty >= 1) {
                cart[index].qty = newQty;
                renderCart();
            }
        }

        // تعيين كمية محددة
        function setQty(index, newQtyValue) {
            const newQty = parseInt(newQtyValue);
            if (isNaN(newQty) || newQty < 1) {
                // إذا كانت القيمة غير صالحة، أعد رسم السلة بالقيمة القديمة
                renderCart();
                return;
            }
            cart[index].qty = newQty;
            renderCart();
        }

        // حذف منتج
        function removeItem(index) {
            cart.splice(index, 1);
            renderCart();
        }

        // إضافة منتج (استدعِ هذه الدالة من صفحة المنتج)
        window.addToCart = function(name, price, image) {
            const existing = cart.find(item => item.name === name && item.image === image);
            if (existing) {
                existing.qty++;
            } else {
                cart.push({ name, price: parseFloat(price), qty: 1, image });
            }
            // يمكنك استبدال alert بنظام إشعارات أفضل
            console.log(`${name} تم إضافته إلى السلة`);
            renderCart();
        };

        // إكمال الشراء عبر واتساب
        document.querySelector('.checkout-btn').addEventListener('click', () => {
            if (cart.length === 0) {
                alert('السلة فارغة!');
                return;
            }

            const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
            let message = `طلب جديد من MAHFOOR CNC\n\n`;
            cart.forEach(item => {
                message += `• ${item.name}\n  الكمية: ${item.qty} × ${item.price} جنيه = ${(item.price * item.qty).toFixed(2)} جنيه\n\n`;
            });
            message += `الإجمالي: ${total.toFixed(2)} جنيه\nالشحن: مجاني`;

            const whatsappURL = `https://wa.me/201033662370?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        });

        // تحميل السلة عند فتح الصفحة
        document.addEventListener('DOMContentLoaded', () => {
            renderCart();
            // يمكنك هنا استدعاء دالة لتحديث عدد المنتجات في أيقونة السلة في رأس الموقع
        });
    </script>

    <!-- زر العودة للأعلى -->
    <button id="back-to-top-btn" title="العودة للأعلى"><i class="fas fa-arrow-up"></i></button>
</body>
</html>